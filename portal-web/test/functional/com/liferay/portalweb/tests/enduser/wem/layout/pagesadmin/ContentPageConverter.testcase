@component-name = "portal-wcm"
definition {

	property osgi.module.configuration.file.names = "com.liferay.layout.admin.web.internal.configuration.LayoutConverterConfiguration.config";
	property osgi.module.configurations = "enabled=B&quot;true&quot;";
	property portal.release = "true";
	property portal.upstream = "true";
	property testray.main.component.name = "Site Pages Administration";

	setUp {
		TestCase.setUpPortalInstance();

		User.firstLoginPG();

		JSONGroup.addGroup(groupName = "Test Site Name");
	}

	tearDown {
		var testPortalInstance = PropsUtil.get("test.portal.instance");

		if ("${testPortalInstance}" == "true") {
			PortalInstances.tearDownCP();
		}
		else {
			JSONGroup.deleteGroupByName(groupName = "Test Site Name");
		}
	}

	@description = "This is a test for LPS-98303. Assert that a page that uses a default layout template, does not have a 'Nested Application' Widget, and is not set as customizable can be converted to a Content Page by default."
	@priority = "5"
	test ConvertBasicWidgetPageToContentPage {
		JSONLayout.addPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name");

		JSONLayout.addWidgetToPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name",
			widgetName = "Asset Publisher");

		SitePages.openPagesAdmin(siteURLKey = "Test Site Name");

		SitePages.gotoPageMenuItem(
			menuItem = "Convert to Content Page",
			pageName = "Test Page Name");

		AssertElementPresent(
			key_pageType = "Content Page",
			locator1 = "SitePages#LIST_GROUP_ITEM_PAGE_TYPE");
	}

	@description = "This is a test for LPS-98589. Multiple widgets with different application decorators survive content page conversion."
	@priority = "5"
	test ConvertWidgetPageDecoratorsToContentPage {
		JSONLayout.addPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name");

		JSONLayout.addWidgetToPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name",
			widgetName = "Asset Publisher");

		JSONLayout.addWidgetToPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name",
			widgetName = "Wiki");

		JSONLayout.addWidgetToPublicLayout(
			groupName = "Test Site Name",
			layoutName = "Test Page Name",
			widgetName = "Documents and Media");

		Navigator.gotoSitePage(
			pageName = "Test Page Name",
			siteName = "Test Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Asset Publisher",
			portletOption = "Look and Feel Configuration");

		IFrame.selectConfigurationFrame();

		Portlet.selectApplicationDecorator(decorator = "Borderless");

		PortletEntry.save();

		Navigator.gotoSitePage(
			pageName = "Test Page Name",
			siteName = "Test Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Wiki",
			portletOption = "Look and Feel Configuration");

		IFrame.selectConfigurationFrame();

		Portlet.selectApplicationDecorator(decorator = "Barebone");

		PortletEntry.save();

		Navigator.gotoSitePage(
			pageName = "Test Page Name",
			siteName = "Test Site Name");

		Portlet.gotoPortletOptions(
			portletName = "Documents and Media",
			portletOption = "Look and Feel Configuration");

		IFrame.selectConfigurationFrame();

		Portlet.selectApplicationDecorator(decorator = "Decorate");

		PortletEntry.save();

		SitePages.openPagesAdmin(siteURLKey = "Test Site Name");

		SitePages.gotoPageMenuItem(
			menuItem = "Convert to Content Page",
			pageName = "Test Page Name");

		AssertElementPresent(
			key_pageType = "Content Page",
			locator1 = "SitePages#LIST_GROUP_ITEM_PAGE_TYPE");

		Navigator.gotoSitePage(
			pageName = "Test Page Name",
			siteName = "Test Site Name");

		Portlet.viewApplicationDecorator(
			decorator = "Borderless",
			portletName = "Asset Publisher");

		Portlet.viewApplicationDecorator(
			decorator = "Barebone",
			portletName = "Wiki");

		Portlet.viewApplicationDecorator(
			decorator = "Decorate",
			portletName = "Documents and Media");
	}

}